# Basic LangExtract Configuration
# Supports different LLM providers via LangExtract's ModelConfig
#
# Required parameters: model_id, provider.name
# Optional parameters use defaults if not specified

lm_recognizer:
  supported_entities:
    - PERSON
    - EMAIL_ADDRESS
    - PHONE_NUMBER
    - US_SSN
    - LOCATION
    - ORGANIZATION
    - DATE_TIME
    - CREDIT_CARD
    - IP_ADDRESS
    - URL
    # Le tue entity custom per cybersecurity
    - ID_INCIDENTE
    - MALWARE
    - RANSOMWARE
    - SERVER_INTERNO
    - INDIRIZZO_IP
    - ATTORE_MINACCIA
    - GRUPPO_APT
    - VULNERABILITA
    - HASH_FILE
    - NOME_UTENTE
    - EMAIL
    - PASSWORD
    - IP_SORGENTE
    - IP_DESTINAZIONE
    - NUMERO_PORTA
    - PROTOCOLLO
    - NOME_PROCESSO
    - COMANDO
    - TECNICA_MITRE
  
  labels_to_ignore:
    - payment_status
    - metadata
    - annotation
  
  enable_generic_consolidation: true
  min_score: 0.5

langextract:
  prompt_file: "presidio-analyzer/presidio_analyzer/conf/langextract_prompts/default_pii_phi_prompt.j2"
  examples_file: "presidio-analyzer/presidio_analyzer/conf/langextract_prompts/default_pii_phi_examples.yaml"

  # ollama example
  model:
    model_id: "gemma3:1b"
    provider:
      name: "ollama"
      kwargs:
        model_url: "http://localhost:11434"
      extract_params:
        temperature: null
        use_schema_constraints: false
        fence_output: false
        max_char_buffer: 400
      language_model_params:
        timeout: 240
        num_ctx: 8192

  # litellm example
  #model:
  #  model_id: "ollama/qwen2.5:1.5b"
  #  provider:
  #    name: "openai"
  #    kwargs:
  #      base_url: "http://localhost:4000"
  #      api_key: "API_KEY_GOES_HERE"
  #    extract_params:
  #      temperature: null
  #      use_schema_constraints: false
  #      fence_output: false
  #      max_char_buffer: 400
  #    language_model_params:
  #      timeout: 240
  #      num_ctx: 8192

  entity_mappings:
    person: PERSON
    name: PERSON
    email: EMAIL_ADDRESS
    phone: PHONE_NUMBER
    ssn: US_SSN
    location: LOCATION
    address: LOCATION
    organization: ORGANIZATION
    date: DATE_TIME
    credit_card: CREDIT_CARD
    ip_address: IP_ADDRESS
    url: URL
    # Custom cybersecurity
    incident_id: ID_INCIDENTE
    malware: MALWARE
    ransomware: RANSOMWARE
    internal_server: SERVER_INTERNO
    indirizzo_ip: INDIRIZZO_IP
    threat_actor: ATTORE_MINACCIA
    apt_group: GRUPPO_APT
    vulnerability: VULNERABILITA
    cve: VULNERABILITA
    file_hash: HASH_FILE
    username: NOME_UTENTE
    password: PASSWORD
    source_ip: IP_SORGENTE
    destination_ip: IP_DESTINAZIONE
    numero_porta: NUMERO_PORTA
    port_number: NUMERO_PORTA
    protocol: PROTOCOLLO
    process_name: NOME_PROCESSO
    command: COMANDO
    mitre_technique: TECNICA_MITRE
